---
title: Middlewares
icon: Shield
---

Por defecto, CodeNExT viene con un middleware de autenticación y roles.

### Autenticación y Roles

El middleware `roleMiddleware` protege las rutas según el rol del usuario:

```ts title="src/middlewares/monday.ts"
// Ruta solo para administradores
.post("/", roleMiddleware("admin"), (c) => {
  // Solo los administradores llegarán aquí
})

// Ruta para cualquier usuario autenticado
.get("/", roleMiddleware("user"), (c) => {
  // Cualquier usuario autenticado puede acceder
})
```

### Registrar Middlewares

De ejemplo, vamos a crear un middleware que solo permita acceder a la ruta el día lunes.
Para registrar un middleware, debemos crear un archivo en la carpeta `src/middlewares/*.ts`:

```ts title="src/middlewares/monday.ts"
export const mondayMiddleware = async (c: Context, next: Next) => {
	const day = new Date().getDay();

	if (day !== 1) {
		return c.json({ error: "Only Monday is allowed" }, 401);
	}

	return next();
};
```

Luego, puedes usar el middleware en una ruta:

```ts title="src/routes/example.ts"
exampleRouter
	// [!code word:mondayMiddleware]
	.get("/", mondayMiddleware, (c) => {
		// Solo se podrá acceder a esta ruta el día lunes
		return c.json({ message: "Hello, world!" });
	})
```
