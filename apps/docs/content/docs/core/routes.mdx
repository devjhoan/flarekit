---
title: API Routes
icon: Route
---

El backend utiliza [Hono](https://hono.dev/) como framework para la creaci√≥n de APIs, junto con [Zod](https://zod.dev/) para la validaci√≥n de datos.

## Estructura de Rutas

Las rutas se organizan en la carpeta `src/routes/v1/` siguiendo una estructura modular:

```
src/routes/v1/
‚îú‚îÄ‚îÄ example.router.ts
‚îî‚îÄ‚îÄ products.router.ts
```

## Creaci√≥n de Rutas

Ejemplo de un router completo con validaci√≥n y autenticaci√≥n:

```typescript
import { roleMiddleware } from "@/middlewares/auth";
import { zValidator } from "@hono/zod-validator";
import { Hono } from "hono";
import { z } from "zod";

// 1. Define tus esquemas de validaci√≥n
const userSchema = z.object({
  name: z.string(),
});

const idParamSchema = z.object({
  id: z.string().uuid(),
});

// 2. Crea los validadores
const userValidator = zValidator("json", userSchema);
const idParamValidator = zValidator("param", idParamSchema);

// 3. Crea y exporta tu router
export const exampleRouter = new Hono()
  // GET /api/v1/example
  .get("/", (c) => {
    return c.json({ data: "lista de items" });
  })

  // GET /api/v1/example/:id
  .get("/:id", idParamValidator, (c) => {
    const { id } = c.req.valid("param");
    return c.json({ id });
  })

  // POST /api/v1/example (solo admin)
  .post("/", 
    roleMiddleware("admin"), // üëà Protecci√≥n de ruta
    userValidator,          // üëà Validaci√≥n de datos
    (c) => {
      const data = c.req.valid("json");
      return c.json(data);
    }
  );
```

### Validaci√≥n con Zod

Utiliza `zValidator` para validar datos de entrada:

```typescript
// 1. Define el esquema
const createPostSchema = z.object({
  title: z.string().min(3),
  content: z.string(),
  published: z.boolean().default(false),
});

// 2. Crea el validador
const createPostValidator = zValidator("json", createPostSchema);

// 3. Usa el validador en la ruta
.post("/posts", createPostValidator, (c) => {
  const data = c.req.valid("json");
  // data est√° tipado y validado ‚ú®
})
```

## Tipos de Validaci√≥n

Hono + Zod soporta validaci√≥n para:

- `param`: Par√°metros de URL
- `query`: Query strings
- `json`: Cuerpo de la petici√≥n
- `header`: Headers de la petici√≥n

Ejemplo completo:

```typescript
const router = new Hono()
  .get("/:id",
    zValidator("param", z.object({ id: z.string() })),
    zValidator("query", z.object({ filter: z.string().optional() })),
    (c) => {
      const { id } = c.req.valid("param");
      const { filter } = c.req.valid("query");
      return c.json({ id, filter });
    }
  );
```

## Respuestas de Error

Las validaciones generan autom√°ticamente respuestas de error apropiadas:

```json
// 400 Bad Request
{
  "error": {
    "issues": [
      {
        "code": "invalid_type",
        "message": "Expected string, received number",
        "path": ["name"]
      }
    ]
  }
}
```

## Mejores Pr√°cticas

1. **Organizaci√≥n**:
   - Un archivo por recurso
   - Nombres descriptivos para las rutas
   - Versiona tus APIs (v1, v2, etc.)

2. **Seguridad**:
   - Usa middlewares de autenticaci√≥n
   - Valida TODOS los inputs
   - Define roles apropiados

3. **Validaci√≥n**:
   - Crea esquemas reutilizables
   - Valida tanto params como body
   - Define tipos TypeScript desde Zod

4. **Respuestas**:
   - Usa c√≥digos HTTP apropiados
   - Mant√©n un formato consistente
   - Incluye mensajes descriptivos 